<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Vaccine Mandate Policy Decision-Aid Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <link rel="stylesheet" href="styles.css" />

  <!-- Charts + export libraries -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>
  <header class="app-header">
    <div class="app-header__title-block">
      <h1>Vaccine Mandate Policy Decision-Aid Tool</h1>
      <p class="app-header__subtitle">
        Integrating discrete choice experiment (DCE) preferences, epidemiology, and
        economic evaluation for vaccine mandate design in Australia, France, and Italy.
      </p>
    </div>
    <div class="app-header__actions">
      <button id="export-btn" class="btn btn--primary">Export policy brief (PDF)</button>
    </div>
  </header>

  <main class="app-main">
    <!-- LEFT SIDEBAR: CONFIGURATION -->
    <aside class="sidebar">
      <section class="panel">
        <h2 class="panel__title">1. Context</h2>
        <div class="field">
          <label for="country-select">Country</label>
          <select id="country-select" class="input js-auto-update">
            <option value="AU">Australia</option>
            <option value="IT">Italy</option>
            <option value="FR">France</option>
          </select>
        </div>

        <div class="field field--inline">
          <div>
            <label for="scenario-select">Outbreak scenario</label>
            <select id="scenario-select" class="input js-auto-update">
              <option value="mild">Mild outbreak</option>
              <option value="severe">Severe outbreak</option>
            </select>
          </div>
          <div>
            <label for="baseline-uptake-input">Baseline vaccination (%)</label>
            <input
              id="baseline-uptake-input"
              class="input js-auto-update"
              type="number"
              min="0"
              max="100"
              step="1"
              value="70"
            />
          </div>
        </div>

        <div class="field">
          <label for="population-input">Population size (people)</label>
          <input
            id="population-input"
            class="input js-auto-update"
            type="number"
            min="0"
            step="10000"
            value="25000000"
          />
        </div>
      </section>

      <section class="panel">
        <h2 class="panel__title">2. Mandate design</h2>

        <div class="field">
          <label for="scope-select">Scope of mandate</label>
          <select id="scope-select" class="input js-auto-update">
            <option value="high_risk">High-risk occupations only</option>
            <option value="all_public">All occupations &amp; public spaces</option>
          </select>
          <p class="field__hint">
            Who is required to be vaccinated.
          </p>
        </div>

        <div class="field">
          <label for="exemptions-select">Exemption policy</label>
          <select id="exemptions-select" class="input js-auto-update">
            <option value="medical_only">Medical only</option>
            <option value="medical_religious">Medical + religious</option>
            <option value="medical_religious_personal">
              Medical + religious + personal belief
            </option>
          </select>
        </div>

        <div class="field">
          <label for="coverage-select">Coverage requirement to lift mandate</label>
          <select id="coverage-select" class="input js-auto-update">
            <option value="cov50">50% of population vaccinated</option>
            <option value="cov70">70% of population vaccinated</option>
            <option value="cov90">90% of population vaccinated</option>
          </select>
        </div>

        <div class="field">
          <label for="lives-select">Estimated lives saved (per 100,000)</label>
          <select id="lives-select" class="input js-auto-update">
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="35">35</option>
            <option value="40">40</option>
          </select>
        </div>
      </section>

      <section class="panel">
        <h2 class="panel__title">3. Epidemiology</h2>

        <div class="field field--inline">
          <div>
            <label for="ve-input">Vaccine effectiveness (VE, %)</label>
            <input
              id="ve-input"
              type="number"
              class="input js-auto-update"
              min="0"
              max="100"
              step="1"
              value="70"
            />
          </div>
          <div>
            <label for="attack-rate-input">Attack rate without mandate (%)</label>
            <input
              id="attack-rate-input"
              type="number"
              class="input js-auto-update"
              min="0"
              max="100"
              step="1"
              value="20"
            />
          </div>
        </div>

        <div class="field field--inline">
          <div>
            <label for="hosp-risk-input">Hospitalisation risk (per case, %)</label>
            <input
              id="hosp-risk-input"
              type="number"
              class="input js-auto-update"
              min="0"
              max="100"
              step="0.1"
              value="5"
            />
          </div>
          <div>
            <label for="death-risk-input">Death risk (per case, %)</label>
            <input
              id="death-risk-input"
              type="number"
              class="input js-auto-update"
              min="0"
              max="100"
              step="0.1"
              value="1"
            />
          </div>
        </div>

        <div class="field field--inline">
          <div>
            <label for="qaly-case-input">QALY loss per non-fatal case</label>
            <input
              id="qaly-case-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="0.001"
              value="0.01"
            />
          </div>
          <div>
            <label for="qaly-death-input">QALY loss per death</label>
            <input
              id="qaly-death-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="0.1"
              value="20"
            />
          </div>
        </div>
      </section>

      <section class="panel">
        <h2 class="panel__title">4. Costs &amp; WTP</h2>

        <div class="field">
          <label for="program-cost-input">Public-sector programme cost (total, $)</label>
          <input
            id="program-cost-input"
            type="number"
            class="input js-auto-update"
            min="0"
            step="100000"
            value="50000000"
          />
        </div>

        <div class="field">
          <label for="employer-cost-input">Employer-side costs (total, $)</label>
          <input
            id="employer-cost-input"
            type="number"
            class="input js-auto-update"
            min="0"
            step="100000"
            value="20000000"
          />
        </div>

        <div class="field field--inline">
          <div>
            <label for="cost-per-vacc-input">Cost per vaccination (all-in, $)</label>
            <input
              id="cost-per-vacc-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="1"
              value="30"
            />
          </div>
          <div>
            <label for="doses-per-person-input">Doses per person</label>
            <input
              id="doses-per-person-input"
              type="number"
              class="input js-auto-update"
              min="1"
              step="1"
              value="2"
            />
          </div>
        </div>

        <div class="field field--inline">
          <div>
            <label for="cost-per-case-input">Medical cost per non-hospital case ($)</label>
            <input
              id="cost-per-case-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="1"
              value="200"
            />
          </div>
          <div>
            <label for="cost-per-hosp-input">Medical cost per hospitalisation ($)</label>
            <input
              id="cost-per-hosp-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="1"
              value="10000"
            />
          </div>
        </div>

        <div class="field">
          <label for="cost-per-death-input">End-of-life medical cost per death ($)</label>
          <input
            id="cost-per-death-input"
            type="number"
            class="input js-auto-update"
            min="0"
            step="1"
            value="15000"
          />
        </div>

        <div class="field field--inline">
          <div>
            <label for="vsl-input">Value of a statistical life (VSL, $)</label>
            <input
              id="vsl-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="100000"
              value="5000000"
            />
          </div>
          <div>
            <label for="wtp-input">WTP per QALY (λ, $)</label>
            <input
              id="wtp-input"
              type="number"
              class="input js-auto-update"
              min="0"
              step="1000"
              value="50000"
            />
          </div>
        </div>

        <div class="field field--inline">
          <div>
            <label for="discount-rate-input">Discount rate (%)</label>
            <input
              id="discount-rate-input"
              type="number"
              class="input js-auto-update"
              min="0"
              max="10"
              step="0.5"
              value="3"
            />
          </div>
          <div>
            <label for="time-horizon-input">Time horizon (years)</label>
            <input
              id="time-horizon-input"
              type="number"
              class="input js-auto-update"
              min="1"
              max="10"
              step="1"
              value="1"
            />
          </div>
        </div>
      </section>

      <section class="panel">
        <h2 class="panel__title">5. Equity &amp; social costs</h2>

        <div class="field">
          <label>Share of QALY gains by SES group</label>
          <div class="field--inline">
            <input
              id="share-low-input"
              class="input js-auto-update"
              type="number"
              min="0"
              step="0.01"
              value="0.4"
            />
            <input
              id="share-mid-input"
              class="input js-auto-update"
              type="number"
              min="0"
              step="0.01"
              value="0.35"
            />
            <input
              id="share-high-input"
              class="input js-auto-update"
              type="number"
              min="0"
              step="0.01"
              value="0.25"
            />
          </div>
          <p class="field__hint">
            Values will be normalised to sum to 1. (Low / middle / high SES.)
          </p>
        </div>

        <div class="field field--inline">
          <div>
            <label for="epsilon-input">Equity aversion parameter (ε)</label>
            <input
              id="epsilon-input"
              class="input js-auto-update"
              type="number"
              min="0"
              max="3"
              step="0.1"
              value="1"
            />
          </div>
          <div>
            <label for="social-cost-input">Additional social/political costs ($)</label>
            <input
              id="social-cost-input"
              class="input js-auto-update"
              type="number"
              min="0"
              step="100000"
              value="0"
            />
          </div>
        </div>
      </section>
    </aside>

    <!-- RIGHT SIDE: RESULTS / POLICY BRIEF -->
    <section class="content" id="policy-brief">
      <section class="summary-grid">
        <article class="summary-card">
          <h3>Composite uptake</h3>
          <p class="summary-card__primary">
            <span id="uptake-combined-span">–</span>
          </p>
          <p class="summary-card__secondary">
            MXL: <span id="uptake-mxl-span">–</span> · LC: <span id="uptake-lc-span">–</span>
          </p>
        </article>

        <article class="summary-card">
          <h3>Health impact</h3>
          <p class="summary-card__primary">
            <span id="cases-averted-span">–</span> cases averted
          </p>
          <p class="summary-card__secondary">
            <span id="deaths-averted-span">–</span> deaths averted
          </p>
        </article>

        <article class="summary-card">
          <h3>QALYs &amp; DALYs</h3>
          <p class="summary-card__primary">
            <span id="qaly-span">–</span> QALYs gained
          </p>
          <p class="summary-card__secondary">
            <span id="daly-span">–</span> DALYs averted
          </p>
        </article>

        <article class="summary-card">
          <h3>Economic value</h3>
          <p class="summary-card__primary">
            NMB: <span id="nmb-span">–</span>
          </p>
          <p class="summary-card__secondary">
            Costs: <span id="total-cost-span">–</span> · BCR:
            <span id="bcr-span">–</span>
          </p>
        </article>
      </section>

      <section class="panel panel--wide">
        <h2 class="panel__title">Uptake and behavioural segmentation</h2>

        <div class="panel__content panel__content--split">
          <div class="panel__block">
            <h3>Predicted uptake</h3>
            <canvas id="uptake-chart" height="180"></canvas>
          </div>

          <div class="panel__block">
            <h3>Latent classes</h3>
            <p>
              Mandate-supporters: <strong id="share-supporters-span">–</strong> of
              respondents (uptake: <span id="uptake-supporters-span">–</span>).
              Mandate-resisters: <strong id="share-resisters-span">–</strong> of
              respondents (uptake: <span id="uptake-resisters-span">–</span>).
            </p>
            <canvas id="lc-chart" height="180"></canvas>
          </div>
        </div>
      </section>

      <section class="panel panel--wide">
        <h2 class="panel__title">Benefits and costs</h2>
        <div class="panel__content panel__content--split">
          <div class="panel__block">
            <h3>Benefit metrics</h3>
            <ul class="metric-list">
              <li>
                Additional vaccinated:
                <strong><span id="deltaV-span">–</span></strong>
              </li>
              <li>
                Hospitalisations averted:
                <strong><span id="hosp-averted-span">–</span></strong>
              </li>
              <li>
                Monetised benefits:
                <strong><span id="monetised-benefits-span">–</span></strong>
              </li>
            </ul>
            <canvas id="benefit-chart" height="200"></canvas>
          </div>
          <div class="panel__block">
            <h3>Cost breakdown</h3>
            <ul class="metric-list">
              <li>Public-sector programme: <span id="cost-program-span">–</span></li>
              <li>Employer-side: <span id="cost-employer-span">–</span></li>
              <li>Vaccination costs: <span id="cost-vacc-span">–</span></li>
              <li>Social/political costs: <span id="cost-social-span">–</span></li>
            </ul>
            <canvas id="cost-chart" height="200"></canvas>
          </div>
        </div>
      </section>

      <section class="panel panel--wide">
        <h2 class="panel__title">Cost-effectiveness and uncertainty</h2>
        <div class="panel__content panel__content--split">
          <div class="panel__block">
            <h3>CEA metrics</h3>
            <ul class="metric-list">
              <li>
                Cost per QALY gained:
                <strong><span id="icer-qaly-span">–</span></strong>
              </li>
              <li>
                Cost per additional vaccinated:
                <strong><span id="icer-vacc-span">–</span></strong>
              </li>
              <li>
                Payback time:
                <strong><span id="payback-span">–</span></strong>
              </li>
            </ul>
            <canvas id="tornado-chart" height="200"></canvas>
          </div>
          <div class="panel__block">
            <h3>CEAC (probabilistic sensitivity)</h3>
            <canvas id="ceac-chart" height="220"></canvas>
          </div>
        </div>
      </section>

      <section class="panel panel--wide">
        <h2 class="panel__title">Equity and distribution</h2>
        <div class="panel__content panel__content--split">
          <div class="panel__block">
            <h3>Equity metrics</h3>
            <ul class="metric-list">
              <li>
                Concentration index:
                <strong><span id="conc-index-span">–</span></strong>
              </li>
              <li>
                Equity-adjusted NMB:
                <strong><span id="equity-nmb-span">–</span></strong>
              </li>
            </ul>
          </div>
          <div class="panel__block">
            <h3>QALY gains by SES</h3>
            <canvas id="equity-chart" height="200"></canvas>
          </div>
        </div>
      </section>

      <section class="panel panel--wide panel--muted">
        <h2 class="panel__title">Methods (overview)</h2>
        <div class="panel__content">
          <p>
            Uptake estimates are derived from country- and scenario-specific discrete
            choice experiment (DCE) models. Mixed logit models capture continuous
            preference heterogeneity, and two-class latent class models distinguish
            mandate-supporters from mandate-resisters. Uptake predictions for a given
            mandate design combine both model families.
          </p>
          <p>
            Health outcomes (cases, hospitalisations, deaths, QALYs, DALYs) are derived
            from user-specified assumptions about vaccine effectiveness, infection
            attack rates, and outcome risks. Economic outcomes combine programme,
            employer, vaccination, and social/political costs with avoided medical
            costs, productivity losses, and mortality risk reductions using VSL and
            WTP-per-QALY parameters.
          </p>
          <p>
            Deterministic and probabilistic sensitivity analyses vary key parameters,
            generate cost-effectiveness acceptability curves (CEACs), and construct
            tornado diagrams to visualise the main drivers of net monetary benefit.
            Equity metrics distribute QALY gains across SES groups, compute a simple
            concentration index, and apply equity weights to obtain equity-adjusted
            net monetary benefit.
          </p>
          <p class="panel__note">
            This is a research prototype. Parameter values and model structure should
            be adapted to match the final epidemiological and costing specifications.
          </p>
        </div>
      </section>
    </section>
  </main>

  <footer class="app-footer">
    <span>Vaccine Mandate DCE Decision Aid – prototype interface</span>
    <span>Design ready for integration with back-end / API services.</span>
  </footer>

  <script src="script.js"></script>
</body>
</html>
